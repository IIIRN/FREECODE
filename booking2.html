<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <script>
      function fetchBookings() {
        const name = document.getElementById('name').value;
        google.script.run.withSuccessHandler(displayBookings).getBookings(name);
      }

      function displayBookings(bookings) {
        const bookingList = document.getElementById('bookingList');
        bookingList.innerHTML = '';

        if (bookings.length === 0) {
          bookingList.innerHTML = '<p>No bookings found.</p>';
          return;
        }

        bookings.forEach((booking, index) => {
          const div = document.createElement('div');
          div.innerHTML = `
            <p>Booking ${index + 1}</p>
            <p>Name: ${booking[0]}</p>
            <p>Personnel: ${booking[1]}</p>
            <p>Date & Time: ${new Date(booking[2]).toLocaleString()}</p>
            <button onclick="cancelBooking('${booking[3]}')">Cancel Booking</button>
            <hr>
          `;
          bookingList.appendChild(div);
        });
      }

      function cancelBooking(eventId) {
        google.script.run.withSuccessHandler(bookingCancelled).cancelBooking(eventId);
      }

      function bookingCancelled(response) {
        alert(response);
        fetchBookings();
      }
    </script>
  </head>
  <body>
    <h1>Booking History and Cancellation</h1>
    <p>
      <label for="name">Enter Name:</label>
      <input type="text" id="name" name="name">
      <button onclick="fetchBookings()">Fetch Bookings</button>
    </p>
    <div id="bookingList"></div>
  </body>
</html>
